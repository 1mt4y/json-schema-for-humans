{# 
    content is a template and not a macro in md
        because macro parameters are not through context
        when rendering a template from the macro  and it caused
        serious problems when using recursive calls
    mandatory context parameters: 
    schema
#}
{# context parameters default values #}
{% set skip_headers = skip_headers or False %}
{% set depth = depth or 0 %}
{# end context parameters #}

{% set keys = schema.keywords %}
{# Resolve type #}
{% set type_name = schema.type_name %}
{%- if not skip_headers %}
    {# Display type #}
    {% if not schema is combining %}Type: `{{ type_name }}`{% endif %}

    {# Display default #}
    {% set default_value = schema.default_value %}
    {% if default_value -%}
        Default: `{{ default_value }}`
    {% endif %}

    {% set description = (schema | get_description) %}
    {% include "section_description.html" %}
{% endif %}

{% if schema.should_be_a_link(config) -%}
    Same definition as [{{ schema.links_to.link_name }}](#{{ schema.links_to.html_id }})
{% elif schema.refers_to -%}
    Defined in: {{ schema.ref_path }}
    {%- with schema=schema.refers_to_merged, skip_headers=True, depth=depth -%}
        {% include "content.html" %}
    {% endwith %}
{% else %}
    {# Handle having oneOf or allOf with only one condition #}
    {% if schema.kw_all_of and (schema.kw_all_of.array_items | length) == 1 %}
        {% with schema=schema.kw_all_of.array_items[0], skip_headers=False, depth=depth+1 %}
            {% include "content.html" %}
        {% endwith %}
    {% elif schema.kw_any_of and (schema.kw_any_of.array_items | length) == 1 %}
        {% with schema=schema.kw_any_of.array_items[0], skip_headers=False, depth=depth+1 %}
            {% include "content.html" %}
        {% endwith %}
    {% else %}
        {# Properties, pattern properties, additional properties #}
        {% if schema.type_name == "object" %}
        {% include "section_properties_table.html" %}
        {% endif %}
        
        {# Combining: allOf, anyOf, oneOf, not #}
        {% if schema.kw_all_of %}
            {% with operator="allOf", title="All of(Requirement)", current_node=schema.kw_all_of %}
                {% include "tabbed_section.html" %}
            {% endwith %}
        {% endif %}
        {% if schema.kw_any_of %}
            {% with operator="anyOf", title="Any of(Option)", current_node=schema.kw_any_of %}
                {% include "tabbed_section.html" %}
            {% endwith %}
        {% endif %}
        {% if schema.kw_one_of %}
            {% with operator="oneOf", title="One of(Option)",current_node=schema.kw_one_of %}
                {% include "tabbed_section.html" %}
            {% endwith %}
        {% endif %}
        {% if schema.kw_not %}
            {% include "section_not.html" %}
        {% endif %}

        {# Enum and const #}
        {% if schema.kw_enum -%}
            {% include "section_one_of.html" %}
        {%- endif %}
        {%- if schema.kw_const -%}
            Specific value: `{{ schema.kw_const.literal | python_to_json }}`
        {%- endif -%}

        {# Pattern (Regular Expression) #}
        {% if schema.kw_pattern and schema.examples|length %}
            Must match regular expression: `{{ schema.kw_pattern.literal | escape }}` [Test](https://regex101.com/?regex={{ schema.kw_pattern.literal | escape }}&test_string={{ schema.examples[0].literal | escape }})
        {% elif schema.kw_pattern %}
            Must match regular expression: `{{ schema.kw_pattern.literal | escape }}` [Test](https://regex101.com/?regex={{ schema.kw_pattern.literal | escape }})
        {% endif %}
        {# Conditional subschema, or if-then-else section #}
        {% if schema.has_conditional %}
            {% with skip_headers=False, depth=depth+1 %}
                {% include "section_conditional_subschema.html" %}
            {% endwith %}
        {% endif %}

        {# Required properties that are not defined under "properties". They will only be listed #}
        {% include "section_undocumented_required_properties.html" %}

        {# Show the requested type(s) #}
        {% include "badge_type.html" %}

        {# Show array restrictions #}
        {% if type_name.startswith("array") %}
            {% include "section_array.html" %}
        {% endif %}

        {# Display examples #}
        {% set examples = schema.examples %}
        {% if examples %}
            {% include "section_examples.html" %}
        {% endif %}
    {% endif %}
{% endif %}